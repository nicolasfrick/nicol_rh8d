<launch>

	<!-- motion params -->
	<arg name="move_hand"      default="false" />
	<arg name="hand_period"    default="1.3" />
	<arg name="hand_increment" default="0.1" />
	<arg name="min_pitch"      default="1.0" />
	<arg name="max_pitch"      default="0.2" />
	<arg name="max_yaw"        default="0.8" />
	<arg name="detect_markers" default="true" />
	<arg name="refmarker_csv"  default="" />
	<arg name="debug"          default="false" />
	<arg name="use_tf"          default="false" />
	<arg name="f_loop"          default="1.0" />

	<!-- marker cam params -->
	<arg name="use_markers_camera"  default="true" />
	<arg name="serial_no"           default="822512060411"/>
	<arg name="enable_depth"        default="false"/>
	<arg name="depth_width"         default="1280"/>
	<arg name="depth_height"        default="720"/>  
	<arg name="depth_fps"           default="30"/>
	<arg name="enable_color"        default="true"/>
	<arg name="color_width"         default="1920"/>
	<arg name="color_height"        default="1080"/>
	<arg name="color_fps"           default="30"/>
	<arg name="filters"                   default=""/>
	<arg name="clip_distance"             default="-2"/>
	<arg name="align_depth"               default="true"/>

	<!-- <arg name="use_wrist_camera" default="false" />
	<arg name="use_top_camera" default="false" /> -->

	<!-- rosbag params -->
	<arg name="play_bag"         default="" />
	<arg name="play_bag_rate" default="1" />
	<arg name="play_bag_pause" default="false" />
	<arg name="play_bag_args" default="" />
	<arg name="record_bag"       default="" />
	<arg name="record_bag_delay" default="$(eval 4.5 * hand_period)" />
	<arg name="record_visbag"    default="" />

	<!-- common manager -->
	<node  if="$(arg use_markers_camera)" pkg="nodelet" type="nodelet" name="rs_manager" args="manager" output="screen" required="true" />
	<!-- markers cam -->
	<include if="$(eval use_markers_camera or bool(play_bag))" file="$(find nicol_rh8d)/launch/realsense.launch">
		<arg name="external_manager"    value="true"/>
		<arg name="manager"             value="/rs_manager"/>
		<arg name="use_realsense" value="$(arg use_markers_camera)" />
		<arg name="camera"             value="marker_realsense" />
		<arg name="serial_no"           value="$(arg serial_no)"/>
		<arg name="enable_depth"        value="$(arg enable_depth)"/>
		<arg name="depth_width"         value="$(arg depth_width)"/>
		<arg name="depth_height"        value="$(arg depth_height)"/>  
		<arg name="depth_fps"           value="$(arg depth_fps)"/>
		<arg name="enable_color"        value="$(arg enable_color)"/>
		<arg name="color_width"         value="$(arg color_width)"/>
		<arg name="color_height"        value="$(arg color_height)"/>
		<arg name="color_fps"           value="$(arg color_fps)"/>
		<arg name="filters"                   value="$(arg filters)"/>
		<arg name="clip_distance"             value="$(arg clip_distance)"/>
		<arg name="align_depth"               value="$(arg align_depth)"/>
		<arg name="play_bag" value="$(arg play_bag)"/>
		<arg name="play_bag_rate" value="$(arg play_bag_rate)"/>
		<arg name="play_bag_pause" value="$(arg play_bag_pause)"/>
		<arg name="play_bag_args" value="$(arg play_bag_args)"/>
		<arg name="record_bag" value="$(arg record_bag)"/>
		<arg name="record_bag_delay" value="$(arg record_bag_delay)"/>
	</include>

	<!-- dataset collector script -->
	<node pkg="nicol_rh8d" name="RH8D_dataset_collector" type="collect_rh8d_dataset.py" output="screen" required="true">
		<param name="move_hand"        type="bool"   value="$(arg move_hand)" />
		<param name="hand_period"      type="double" value="$(arg hand_period)" />
		<param name="hand_increment"   type="double" value="$(arg hand_increment)" />
		<param name="min_pitch"        type="double" value="$(arg min_pitch)" />
		<param name="max_pitch"        type="double" value="$(arg max_pitch)" />
		<param name="max_yaw"          type="double" value="$(arg max_yaw)" />
		<param name="detect_markers"   type="bool"   value="$(arg detect_markers)" />
		<param name="refmarker_csv"    type="string" value="$(arg refmarker_csv)" />
		<param name="use_markers_camera"  type="bool"   value="$(arg use_markers_camera)" />
		<param name="camera_width"     type="int"    value="$(arg color_width)" />
		<param name="camera_height"    type="int"    value="$(arg color_height)" />
		<param name="record_visbag"    type="string" value="$(arg record_visbag)" />
		<param name="debug"            type="bool"   value="$(arg debug)" />
		<param name="use_depth" type="bool"   value="$(arg enable_depth)" />
		<param name="depth_width" type="int"   value="$(arg depth_width)" />
		<param name="depth_height" type="int"   value="$(arg depth_height)" />
		<param name="use_tf" type="bool"   value="$(arg use_tf)" />
		<param name="f_loop" type="double"   value="$(arg f_loop)" />
	</node>

	<!-- record detection results -->
	<node if="$(eval bool(record_visbag))" pkg="rosbag" type="record" name="record_camera_visbag" output="screen" args="--lz4 --output-name $(arg record_visbag) /RH8D_dataset_collector/marker_realsense/visimg" required="false" />

</launch>
